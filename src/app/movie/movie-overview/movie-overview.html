<section class="movie-overview">
  <ng-container *ngIf="loadingMovie">
    <app-loading-fullscreen message="Loading movie..."></app-loading-fullscreen>
  </ng-container>
  <ng-container *ngIf="!loadingMovie">
    <ng-container *ngIf="movieOverviewError">
      <app-movie-error
        [errorMessage]="errorMessage"
        (reload)="reloadMovieOverview($event)"
      ></app-movie-error>
    </ng-container>
    <ng-container *ngIf="!movieOverviewError">
      <ng-container *ngIf="movie.tagline">
        <section class="movie-tagline">
          <p>{{ movie.tagline }}</p>
        </section>
      </ng-container>
      <ng-container *ngIf="movie.overview">
        <section class="movie-overview">
          <p>{{ movie.overview }}</p>
        </section>
        <hr />
      </ng-container>
      <ng-container *ngIf="loadingCredits">
        <app-loading-inline message="Loading credits"></app-loading-inline>
      </ng-container>
      <ng-container *ngIf="!loadingCredits">
        <ng-container *ngIf="movieCreditsFound">
          <section class="movie-main-credits">
            <div class="row">
              <div class="col-12 col-lg-4">
                <app-movie-overview-main-cast [movieCast]="credits.cast">
                </app-movie-overview-main-cast>
              </div>
              <div class="col-12 col-lg-8">
                <section class="movie-main-crew">
                  <app-movie-overview-main-crew [movieCrew]="credits.crew">
                  </app-movie-overview-main-crew>
                </section>
              </div>
            </div>
            <div class="row">
              <div class="col-12 col-lg-4">
                <div class="d-grid mb-2">
                  <a [routerLink]="['/movie', movie.id, 'cast']" class="btn btn-primary">
                    See Full Cast
                  </a>
                </div>
              </div>
              <div class="col-12 col-lg-4">
                <div class="d-grid mb-2">
                  <a [routerLink]="['/movie', movie.id, 'crew']" class="btn btn-primary">
                    See Featured Crew
                  </a>
                </div>
              </div>
              <div class="col-12 col-lg-4">
                <div class="d-grid mb-2">
                  <a [routerLink]="['/movie', movie.id, 'full-crew']" class="btn btn-primary">
                    See Full Crew
                  </a>
                </div>
              </div>
            </div>
          </section>
        </ng-container>
        <ng-container *ngIf="!movieCreditsFound">
          <section class="error-credits">
            <p>Error showing credits: <strong>{{ movieCreditsErrorMessage }}</strong></p>
          </section>
        </ng-container>
        <hr />
      </ng-container>
      <div class="row">
        <div class="col-12 col-lg-6">
          <app-movie-overview-trailer [movieId]="id">
          </app-movie-overview-trailer>
        </div>
        <div class="col-12 col-lg-6">
          <section class="movie-info">
            <h3>Movie Info</h3>
            <div class="table table-responsive">
              <table class="table">
                <tbody>
                  <ng-container *ngIf="movie.genres.length > 0">
                    <tr>
                      <td>Genre<ng-container *ngIf="movie.genres.length > 1">s</ng-container>:</td>
                      <td>
                        <ng-container *ngFor="let genres of movie.genres">
                          {{ genres.name }}
                          <br />
                        </ng-container>
                      </td>
                    </tr>
                  </ng-container>
                  <ng-container *ngIf="movie.production_companies.length > 0">
                    <tr>
                      <td>
                        Production Compan<ng-container
                          *ngIf="movie.production_companies.length == 1"
                          >y</ng-container
                        >
                        <ng-container *ngIf="movie.production_companies.length > 1"
                          >ies</ng-container
                        >:
                      </td>
                      <td>
                        <ng-container *ngFor="let productionCompany of movie.production_companies">
                          {{ productionCompany.name }}
                          <br />
                        </ng-container>
                      </td>
                    </tr>
                  </ng-container>
                  <ng-container *ngIf="movie.production_countries.length > 0">
                    <tr>
                      <td>
                        Production Countr<ng-container
                          *ngIf="movie.production_countries.length == 1"
                          >y</ng-container
                        >
                        <ng-container *ngIf="movie.production_countries.length > 1"
                          >ies</ng-container
                        >:
                      </td>
                      <td>
                        <ng-container *ngFor="let productionCountry of movie.production_countries">
                          {{ productionCountry.name }}
                          <br />
                        </ng-container>
                      </td>
                    </tr>
                  </ng-container>
                  <ng-container>
                    <tr>
                      <td>Release Date:</td>
                      <td>{{ movieReleaseDate | date : 'longDate' }}</td>
                    </tr>
                  </ng-container>
                  <ng-container *ngIf="movie.runtime && movie.runtime > 0">
                    <tr>
                      <td>Runtime:</td>
                      <td>{{ movie.runtime }} min</td>
                    </tr>
                  </ng-container>
                  <ng-container *ngIf="movie.budget && movie.budget > 0">
                    <tr>
                      <td>Budget:</td>
                      <td>USD {{ movie.budget | currency : 'USD' : 'symbol' : '1.0' }}</td>
                    </tr>
                  </ng-container>
                  <ng-container *ngIf="movie.revenue && movie.revenue > 0">
                    <tr>
                      <td>Box Office:</td>
                      <td>USD {{ movie.revenue | currency : 'USD' : 'symbol' : '1.0' }}</td>
                    </tr>
                  </ng-container>
                </tbody>
              </table>
            </div>
            <ng-container *ngIf="movie.imdb_id || movie.homepage">
              <section class="movie-external-links">
                <ng-container *ngIf="movie.imdb_id">
                  <div class="d-grid mb-2">
                    <a [href]="movieIMDB" class="btn btn-primary" target="_blank">
                      <fa-icon [icon]="imdbIcon"></fa-icon>
                      View IMDB
                    </a>
                  </div>
                </ng-container>
                <ng-container *ngIf="movie.homepage">
                  <div class="d-grid mb-2">
                    <a [href]="movieHomepage" class="btn btn-primary" target="_blank">
                      <fa-icon [icon]="globeIcon"></fa-icon>
                      View Homepage
                    </a>
                  </div>
                </ng-container>
              </section>
            </ng-container>
          </section>
        </div>
      </div>
    </ng-container>
  </ng-container>
</section>
